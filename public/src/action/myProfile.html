<link href="asset/css/registration.css" rel="stylesheet">
<inject from="/component/alert" name="alert"></inject>
<inject from="/component/userProfile" name="profile"></inject>

<profile profile.bind="getMyProfile()" save.trigger="save(event)" cancel.trigger="cancel()"></profile>

<script>

	var errorMessage = '';

	function getMyProfile(){

		return new Promise(function(resolve) {
            dpd.users.me(function(me) {
                    resolve(me);
                });
		});
	}

	function cancel() {
		window.location.hash = "#app";
	}
	function save(profile){
		dpd.users.put(profile.id, profile, function(user, err) {
			if(err){
				errorMessage = err.message;
			}
			$patchChanges();
		});
		return false;
	}
</script>

