<link href="asset/css/registration.css" rel="stylesheet">
<inject from="/component/alert" name="alert"></inject>
<inject from="/component/userProfile" name="profile"></inject>

<div>
    <profile profile.bind="getMyProfile()" save.trigger="save(event)" cancel.trigger="cancel()"></profile>
</div>

<script>

	var errorMessage = '';

	function getMyProfile(){

		return new Promise(function(resolve) {
            dpd.users.me(function(me) {
                    resolve(me);
                });
		});
	}

	function cancel() {
		window.location.hash = "#app";
	}
	function save(profile){
	    return new Promise(function(resolve){
            dpd.users.put(profile.id, profile, function(user, err) {
                if(err) {
                    resolve(err)
                } else {
                    window.location.hash = '#app';
                }
            });
        });
	}
</script>

