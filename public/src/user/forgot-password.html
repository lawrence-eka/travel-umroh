<inject from="/user/userProfile" name="profile"></inject>
<inject from="/component/panel" name="panel"></inject>
<inject from="/component/entry" name="entry"></inject>
<inject from="/component/alert" name="alert"></inject>

<div class="container small-margin-top">
    <panel >
        <div slot.name="title">
            <strong>Forgot Your Password?</strong>
        </div>
        <div slot.name="body">
            <form>
                <div class="row">
                    <entry type="email" name="email" required prompt="Your Email Address"></entry>
                    <entry type="button" value="Reset Password" click.trigger="onResetPassword()"></entry>
                    <entry type="button" value="Cancel"click.trigger="onCancel()"></entry>
                </div>
            </form>
        </div>
        <div slot.name="footer">
            Please Enter your email address
        </div>
    </panel>
    <span ref.name="alert">
        <alert alertType.bind="@alert.type()" message.bind="@alert.text()"></alert>
    </span>
</div>

<script>
	function initState() {
		return {
			alert: new Alert(null, $patchChanges, "alert")
		}
	}

	function onResetPassword() {
		debugger;
		var q = {
			email: this.target.form.elements.email.value,
            resetPassword: "-",
        }
		debugger;
        var self = this;
        dpd.resetpassword.post("", q, function(res, err) {
	        debugger;
        	self.state.alert.alert(err);
        	if(!err) {
        		window.location.has="#app";
            }
        });
    }

	function onCancel() {
		window.location.hash="#app/user.login-form"
    }
</script>

