<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <meta name="description" content="">
        <meta name="author" content="">
        <link rel="icon" href="asset/favicon.ico">

        <script src="dist/yalla.js"
                yalla-component="app"
                yalla-base="dist"
                yalla-domtarget="body" yalla-routing="authenticate">
        </script>
        <script src="asset/js/own/storages.js"></script>
        <!-- Bootstrap core CSS -->
    <style>
        body {
            background: url('/asset/img/image5.jpg') no-repeat center center fixed;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;
            background-color:#333;
            font-family: 'Open Sans',Arial,Helvetica,Sans-Serif;
        }
    </style>
    </head>
    <body >
    </body>
    <script>
        function authenticate(path){
            return new Promise(function(resolve){
                /*
                var defaultPath = '#!/app';
                var login = '#!/app/user.login-form';
                if(path=="") resolve(defaultPath);
                else resolve(path);
                */
                resolve(path);
            });
        }

        var assets=[
	        {seq: 0, file: "asset/js/own/yalla-patch.js"},
	        {seq: 0, file: "asset/css/form-panel.css"},
	        {seq: 0, file: "asset/css/font-awesome.min.css"},
	        {seq: 0, file: "asset/css/bootstrap.min.css"},
	        {seq: 1, file: "asset/css/css-patch.css"},
	        {seq: 1, file: "asset/css/custom-style.css"},
	        {seq: 0, file: "asset/css/ie10-viewport-bug-workaround.css"},
	        {seq: 0, file: "asset/css/sticky-footer-navbar.css"},
	        {seq: 0, file: "asset/js/jquery.min.js"},
	        {seq: 2, file: "asset/js/bootstrap.min.js"},
	        {seq: 0, file: "dpd.js"},
	        {seq: 0, file: "asset/js/own/prototypes.js"},
	        {seq: 1, file: "asset/js/own/datePair.js"},
	        {seq: 1, file: "asset/js/own/alert.js"},
	        {seq: 1, file: "asset/js/own/utils.js"},
	        {seq: 1, file: "asset/js/own/event.js"},
	        //{seq: -2, file: "dist/yalla.js", attribute:{"yalla-component": "app", "yalla-base": "dist", "yalla-domtarget": "body", "yalla-routing":"authenticate"}},
        ];

        function loadAssets(seq) {
        	seq = seq == null ? 0:seq;
        	for(var i in assets) {
        		if(assets[i].seq == seq && !assets[i].called) {
        			console.log("loading asset seq:", seq, "=", assets[i].file)
			        assets[i].called=true;
			        var asset = assets[i];
			        var resolveCallback= function(req) {
				        loader.attachScriptToDocument("/" +  this.file);
				        console.log("asset seq:", this.seq, '=', this.file, "loaded.")
				        loadAssets(this.seq + 1);
			        };
			        loader.fetch("./" + asset.file, null, asset.attribute).then(resolveCallback.bind(asset));
                }
            }
        }
//debugger;
        loadAssets(0);
    </script>
</html>
