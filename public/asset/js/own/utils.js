function Utils(){var self=this;self.propertiesUpdater=function(target,source,which){for(var key in target)source.hasOwnProperty(key)&&(target[key]=source[key][which]);return target},self.generateUUID=function(){var d=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(d+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"===c?r:3&r|8).toString(16)})},self.itineraries={},self.itineraries.recommendedNewDates=function(packageId){return new Promise(function(resolve){var q={packageId:packageId,$sort:{fromDateTime:-1},$limit:1};dpd.itineraries.get(q,function(res){resolve(res.length?new Date(res[0].toDateTime):new Date)})})},self.bookings={paymentRejected:-3,bookingCancelled:-2,bookingExpired:-1,definingPassengers:0,waitingForPayment:1,paymentConfirmationPending:2,readyToGo:3,onGoing:4,finished:5},self.bookings.status=function(booking){return booking.isPaymentConfirmed==-1?{code:self.bookings.paymentRejected,text:"Payment Rejected"}:booking.isCancelled?{code:self.bookings.bookingCancelled,text:"Cancelled"}:booking.waitingForPaymentUntil&&booking.waitingForPaymentUntil<(new Date).getTime()?{code:self.bookings.bookingExpired,text:"Cancelled due to no Payment"}:booking.uniqueCode?booking.actualPayment?booking.isPaymentConfirmed?booking.travelDateFrom>(new Date).getTime()?{code:self.bookings.readyToGo,text:"Ready to Go"}:booking.travelDateUntil>=(new Date).getTime()?{code:self.bookings.onGoing,text:"On Going"}:{code:self.bookings.finished,text:"Finished"}:{code:self.bookings.paymentConfirmationPending,text:"Payment Confirmation Pending"}:{code:self.bookings.waitingForPayment,text:"Waiting for Payment"}:{code:self.bookings.definingPassengers,text:"Defining Passengers"}},Object.freeze(self.bookings)}