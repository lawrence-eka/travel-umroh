yalla.utils.fetch=function(url,postData){function createXMLHTTPObject(){for(var xmlhttp=!1,i=0;i<XMLHttpFactories.length;i++){try{xmlhttp=XMLHttpFactories[i]()}catch(e){continue}break}return xmlhttp}var XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];return new Promise(function(resolve,reject){var script=scriptCache.getScript(url);if(script)resolve(script);else if(scriptCache.addPromise(url,null,resolve,reject)){var req=createXMLHTTPObject();if(req.timeout=2e3,req){var method=postData?"POST":"GET";req.open(method,url,!0),postData&&req.setRequestHeader("Content-type","application/json"),req.ontimeout=function(){scriptCache.setScript(url)},req.onreadystatechange=function(){4==req.readyState&&(200==req.status||304==req.status?scriptCache.setScript(url,req):scriptCache.setScript(url,null))},4!=req.readyState&&req.send(JSON.stringify(postData))}}})},yalla.framework.attachScriptToDocument=function(url){return url.substring(0,url.length-".js".length)in yalla.components?Promise.resolve(!0):url in yalla.framework.componentLoadListener?Promise.resolve(!0):new Promise(function(resolve){var s=null;(s=document.createElement("script")).type="text/javascript",s.text=scriptCache.scripts["."+url].req.responseText,document.head.appendChild(s),yalla.framework.componentLoadListener[url]=function(){resolve(url),delete yalla.framework.componentLoadListener[url]},resolve(url)})},yalla.framework.start=function(){var scripts=document.querySelector("script[id='yallaScript']")||[];if(!yalla.utils.assertNotNull(scripts.attributes["yalla-component"],scripts.attributes["yalla-base"],scripts.attributes["yalla-domtarget"]))throw new Error("script tag should contain attributes 'yalla-component', 'yalla-base' and 'yalla-domtarget'");var component=scripts.attributes["yalla-component"].nodeValue,base=scripts.attributes["yalla-base"].nodeValue,domTarget=scripts.attributes["yalla-domtarget"].nodeValue,routingCallback=!!scripts.attributes["yalla-routing"]&&scripts.attributes["yalla-routing"].nodeValue;yalla.framework.base=base,yalla.framework.domTarget=domTarget,yalla.framework.defaultComponent=component,yalla.framework.beforeRenderToScreen=function(){return new Promise(function(resolve){if(routingCallback&&"function"==typeof window[routingCallback]){var path=window.location.hash;window[routingCallback](path).then(function(newPath){newPath&&newPath!=path?(resolve(!1),yalla.log.info("Re-routing path to new location"),window.location.hash=newPath):resolve(!0)})}else resolve(!0)})},yalla.framework.renderToScreen()};