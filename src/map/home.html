<inject from="/component/panel" name="panel"></inject>
<inject from="/component/home-button" name="home"></inject>
<inject from="/component/alert" name="alert"></inject>

<div>
    <panel title='Map'>
        <div slot.name='body'>
            <span ref.name="alert">
                <alert alertType.bind="@alert.type()" message.bind="@alert.text()"></alert>
            </span>
            <div name = 'map' style.bind='@screenSize'>

            </div>
        </div>
        <div slot.name="footer">
            <div class="row">
                <home></home>
            </div>
        </div>
    </panel>
</div>

<script>
    function initState(props){
    	var state = {
		    screenSize:'width:100%;height:' + screen.height * 0.6 + 'px',
		    alert: new Alert(null, $patchChanges, "alert"),
            infoText:'',
        }
	    if((typeof google) == 'undefined') {
    		state.alert.alert('Google Map is not available at the moment');
	    } else {
    		initMap();
        }

        return state;
    }

	function initMap() {
		geo.showLocation(document.getElementsByName('map')[0]);
	}

    window.onload = function(e){
	    if((typeof google) != 'undefined') initMap();
    }

</script>
